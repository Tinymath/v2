<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Fetcher Overlay</title>

<style>
  body {
    font-family: Arial, sans-serif;
  }

  /* Search bar */
  #searchBarContainer {
    width: 100%;
    padding: 15px;
    background: #f0f0f0;
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 10px;
  }

  #searchLabel {
    font-size: 20px;
    font-weight: bold;
  }

  #searchInput {
    width: 300px;
    padding: 8px;
    font-size: 16px;
    border-radius: 6px;
    border: 1px solid #ccc;
  }

  /* Button grid */
  .button-row {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 25px;
    margin: 20px;
  }

  .fetch-btn {
    text-align: center;
    cursor: pointer;
    width: 100%;
    font-family: Arial, sans-serif;
  }

  /* FIXED button size */
  .fetch-btn img {
    width: 140px;
    height: 140px;
    object-fit: cover;
    border-radius: 8px;
  }

  /* FIXED label height */
  .fetch-btn .label {
    margin-top: 8px;
    font-size: 16px;
    font-weight: bold;
    height: 28px; /* SAME HEIGHT ALWAYS */
    display: flex;
    justify-content: center;
    align-items: center;
    font-family: Arial, sans-serif;
  }

  /* Overlay */
  #overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background: #000;
    color: white;
    overflow-y: auto;
    display: none;
    z-index: 9999;
    padding: 20px;
  }

  /* Overlay buttons */
  #closeBtn, #fullscreenBtn, #blankBtn {
    position: fixed;
    top: 15px;
    padding: 8px 14px;
    border-radius: 6px;
    cursor: pointer;
    font-weight: bold;
    z-index: 10000;
    font-family: Arial, sans-serif;
  }

  #closeBtn {
    right: 20px;
    background: white;
    color: black;
  }

  #fullscreenBtn {
    right: 140px;
    background: #1e90ff;
    color: white;
  }

  #blankBtn {
    right: 260px;
    background: #32cd32;
    color: white;
  }
</style>
</head>
<body>

<!-- Search bar -->
<div id="searchBarContainer">
  <div id="searchLabel">tinymath</div>
  <input id="searchInput" type="text" placeholder="Search buttons...">
</div>

<!-- Buttons -->
<div class="button-row" id="buttonRow">

  <div class="fetch-btn" data-url="https://raw.githubusercontent.com/Tinymath/v2/refs/heads/main/2048.html" data-name="2048">
    <img src="https://th.bing.com/th/id/OIP.L_bQEFJ-kMEdVwIrRo2k7wHaHa?w=180&h=180&c=7&r=0&o=7&dpr=1.3&pid=1.7&rm=3">
    <div class="label">Cloverdust Page</div>
  </div>

  <!-- Add more buttons here -->

</div>

<!-- Overlay -->
<div id="overlay">
  <div id="closeBtn">Close</div>
  <div id="fullscreenBtn">Fullscreen</div>
  <div id="blankBtn">Open in Blank</div>
  <div id="content"></div>
</div>

<script>
const overlay = document.getElementById("overlay");
const content = document.getElementById("content");
const closeBtn = document.getElementById("closeBtn");
const fullscreenBtn = document.getElementById("fullscreenBtn");
const blankBtn = document.getElementById("blankBtn");
const buttonRow = document.getElementById("buttonRow");
const searchBar = document.getElementById("searchBarContainer");

let lastFetchedHTML = "";
let lastURL = "";

/* Fetch buttons */
document.querySelectorAll(".fetch-btn").forEach(btn => {
  btn.onclick = async () => {
    overlay.style.display = "block";
    content.innerHTML = "<p>Loading...</p>";

    lastURL = btn.getAttribute("data-url");

    try {
      const response = await fetch(lastURL);
      const html = await response.text();
      lastFetchedHTML = html;
      content.innerHTML = html;
    } catch (err) {
      content.innerHTML = "<p>Error loading content.</p>";
    }
  };
});

/* Close overlay */
closeBtn.onclick = () => {
  overlay.style.display = "none";
  content.innerHTML = "";
};

/* Fullscreen toggle */
fullscreenBtn.onclick = () => {
  if (!document.fullscreenElement) {
    overlay.requestFullscreen();
  } else {
    document.exitFullscreen();
  }
};

/* Open in about:blank */
blankBtn.onclick = () => {
  const win = window.open("about:blank", "_blank");
  win.document.write(lastFetchedHTML || "<p>No content loaded yet.</p>");
};

/* Hide ALL UI in fullscreen */
document.addEventListener("fullscreenchange", () => {
  const isFull = !!document.fullscreenElement;

  buttonRow.style.display = isFull ? "none" : "grid";
  searchBar.style.display = isFull ? "none" : "flex";
  closeBtn.style.display = isFull ? "none" : "block";
  fullscreenBtn.style.display = isFull ? "none" : "block";
  blankBtn.style.display = isFull ? "none" : "block";
});

/* Live search filter */
document.getElementById("searchInput").oninput = () => {
  const query = document.getElementById("searchInput").value.toLowerCase();

  document.querySelectorAll(".fetch-btn").forEach(btn => {
    const name = btn.getAttribute("data-name").toLowerCase();
    btn.style.display = name.includes(query) ? "block" : "none";
  });
};
</script>

</body>
</html>
